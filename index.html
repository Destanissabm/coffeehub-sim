<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Dashboard | CoffeeHub</title>
  <link rel="stylesheet" href="style.css">
  <style>
    /* Styling katalog / katalog enhancements (gabungan dari products.html) */
    .katalog-container {
        padding: 20px;
        text-align: center;
    }

    .produk-grid, .product-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        margin-top: 20px;
    }

    .produk-card, .product-card {
        background:#fff;
        border-radius:8px;
        padding:12px;
        box-shadow:0 1px 4px rgba(0,0,0,0.08);
        text-align:center;
        transition: 0.3s;
    }

    .produk-card img, .product-card img {
        width:100%;
        height:140px;
        object-fit:cover;
        border-radius:6px;
        margin-bottom:8px;
    }

    .produk-card h3, .product-card h4 {
        margin:6px 0;
        font-size:1rem;
    }

    .produk-card p, .product-price {
        font-weight: bold;
        color: #333;
    }

    .btn {
      padding:8px 10px;
      border-radius:6px;
      border:none;
      cursor:pointer;
    }
    .btn-primary { background:#6b4f4f; color:#fff; }
    .btn-outline { background:#fff; border:1px solid #6b4f4f; color:#6b4f4f; }

    /* catalog header controls */
    .catalog-header {
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:1rem;
      margin-bottom:1rem;
      flex-wrap:wrap;
    }
    .search-input {
      padding:8px;
      border-radius:4px;
      border:1px solid #ccc;
      width:220px;
    }
    .filter-select {
      padding:8px;
      border-radius:4px;
      border:1px solid #ccc;
    }

    /* modal */
    .modal {
      position:fixed;
      inset:0;
      display:none;
      align-items:center;
      justify-content:center;
      background:rgba(0,0,0,0.4);
      z-index:1000;
    }
    .modal .dialog {
      background:#fff;
      padding:16px;
      border-radius:8px;
      width:90%;
      max-width:520px;
      max-height:90vh;
      overflow:auto;
    }

    .produk-card:hover, .product-card:hover {
      box-shadow: 0 5px 15px rgba(0,0,0,0.12);
    }
  </style>
</head>
<body>

<script>
  if (localStorage.getItem("login") !== "true") {
    window.location.href = "login.html";
  }
</script>

<header>
  <h1>CoffeeHub</h1>
  <p>Dashboard Sistem Informasi Manajemen</p>
</header>

<div class="container">
  <aside class="sidebar">
    <ul>
      <li><a href="index.html" class="active">Dashboard</a></li>
      <li><a href="keuangan.html">Keuangan</a></li>
      <li><a href="pemasaran.html">Pemasaran</a></li>
      <li><a href="sdm.html">SDM</a></li>
      <li><a href="produksi.html">Produksi</a></li>
      <li><a href="#" onclick="logout()">Logout</a></li>
    </ul>
  </aside>

<main class="content">
  <h2>Dashboard Manajemen</h2>
  <p>Ringkasan kinerja operasional CoffeeHub</p>

  <!-- KPI CARDS -->
  <div class="cards">
    <div class="card">
      <span>Pendapatan Hari Ini</span>
      <h3>Rp 3.500.000</h3>
    </div>
    <div class="card">
      <span>Total Transaksi</span>
      <h3>120</h3>
    </div>
    <div class="card">
      <span>Pelanggan Loyal</span>
      <h3>85</h3>
    </div>
    <div class="card">
      <span>Barista Aktif</span>
      <h3>6 Orang</h3>
    </div>
  </div>

  <!-- GRAFIK -->
  <div class="cards" style="margin-top:30px;">
    <div class="card">
      <h3>Grafik Penjualan Mingguan</h3>
      <canvas id="salesChart"></canvas>
    </div>

    <div class="card">
      <h3>Grafik Pendapatan Bulanan</h3>
      <canvas id="revenueChart"></canvas>
    </div>
  </div>

  <!-- TABEL TRANSAKSI -->
  <div class="card" style="margin-top:30px;">
    <h3>Transaksi Terbaru</h3>
    <table>
      <tr>
        <th>Tanggal</th>
        <th>Produk</th>
        <th>Jumlah</th>
        <th>Total</th>
      </tr>
      <tr>
        <td>12 Jan 2026</td>
        <td>Latte</td>
        <td>3</td>
        <td>Rp 75.000</td>
      </tr>
      <tr>
        <td>12 Jan 2026</td>
        <td>Americano</td>
        <td>2</td>
        <td>Rp 40.000</td>
      </tr>
      <tr>
        <td>11 Jan 2026</td>
        <td>Cappuccino</td>
        <td>4</td>
        <td>Rp 120.000</td>
      </tr>
    </table>
  </div>

  <!-- INSIGHT -->
  <div class="card" style="margin-top:30px;">
    <h3>Insight Manajerial</h3>
    <p>
      Penjualan tertinggi terjadi pada akhir pekan, menunjukkan peningkatan
      permintaan pelanggan. Strategi promosi dapat difokuskan pada hari kerja
      untuk menstabilkan pendapatan.
    </p>
  </div>

  <!-- KATALOG PRODUK (ditambahkan: search, filter, modal, cart) -->
  <section id="katalog" class="katalog-container">
    <h2>Katalog Kopi</h2>

    <div class="catalog-header" style="max-width:1000px; margin:0 auto;">
      <div style="display:flex; gap:8px; align-items:center;">
        <input id="search" class="search-input" placeholder="Cari produk, cont. Latte..." />
        <select id="category" class="filter-select">
          <option value="">Semua Kategori</option>
          <option value="kopi">Kopi</option>
          <option value="makanan">Makanan</option>
          <option value="minuman">Minuman Non-Kopi</option>
        </select>
      </div>
      <div>
        <button class="btn btn-outline" onclick="viewCart()">Lihat Keranjang (<span id="cartCount">0</span>)</button>
      </div>
    </div>

    <div id="productGrid" class="produk-grid product-grid" style="max-width:1000px; margin:0 auto;"></div>
  </section>

  <!-- Modal detail produk -->
  <div id="productModal" class="modal" onclick="closeModal(event)">
    <div class="dialog" onclick="event.stopPropagation()">
      <h3 id="modalTitle"></h3>
      <img id="modalImage" src="" alt="" style="width:100%; height:220px; object-fit:cover; border-radius:6px; margin-bottom:8px;">
      <p id="modalDesc"></p>
      <p class="product-price" id="modalPrice"></p>
      <div style="display:flex; gap:8px; justify-content:flex-end; margin-top:8px;">
        <button class="btn btn-outline" onclick="closeModal()">Tutup</button>
        <button class="btn btn-primary" id="modalAdd">Tambah ke Keranjang</button>
      </div>
    </div>
  </div>

  <!-- Simple cart drawer (modal) -->
  <div id="cartModal" class="modal" onclick="closeCart(event)">
    <div class="dialog" onclick="event.stopPropagation()">
      <h3>Keranjang Anda</h3>
      <div id="cartItems"></div>
      <p style="margin-top:12px; font-weight:600;">Total: <span id="cartTotal">Rp 0</span></p>
      <div style="display:flex; gap:8px; justify-content:flex-end; margin-top:8px;">
        <button class="btn btn-outline" onclick="closeCart()">Tutup</button>
        <button class="btn btn-primary" onclick="checkout()">Checkout</button>
      </div>
    </div>
  </div>

</main>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<!-- KATALOG & KERANJANG SCRIPT -->
<script>
  // Data produk gabungan (lengkap dengan gambar)
  const products = [
    { id:1, name:"Espresso", category:"kopi", price:15000, desc:"Shot kopi pekat, klasik.", img:"https://i.ibb.co/4fK6y0F/espresso.jpg" },
    { id:2, name:"Latte", category:"kopi", price:25000, desc:"Kopi susu lembut, favorit banyak orang.", img:"https://i.ibb.co/1mPWhhK/latte.jpg" },
    { id:3, name:"Cappuccino", category:"kopi", price:30000, desc:"Espresso dengan busa susu tebal.", img:"https://i.ibb.co/1rSzV0G/cappuccino.jpg" },
    { id:4, name:"Americano", category:"kopi", price:20000, desc:"Kopi panjang, ringan dan jernih.", img:"https://i.ibb.co/ZxkZ8kF/americano.jpg" },
    { id:5, name:"Mocha", category:"kopi", price:32000, desc:"Cokelat dan espresso berpadu.", img:"https://i.ibb.co/2FZ0L6V/mocha.jpg" },
    { id:6, name:"Croissant", category:"makanan", price:18000, desc:"Roti renyah, cocok untuk sarapan.", img:"https://i.ibb.co/3yqQb0s/croissant.jpg" },
    { id:7, name:"Iced Tea", category:"minuman", price:12000, desc:"Teh dingin segar.", img:"https://i.ibb.co/8r0tV5H/iced-tea.jpg" }
  ];

  const productGrid = document.getElementById('productGrid');
  const searchInput = document.getElementById('search');
  const categorySelect = document.getElementById('category');
  const cartCountEl = document.getElementById('cartCount');

  function formatCurrency(v){
    return 'Rp ' + v.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
  }

  function renderProducts(){
    const q = searchInput.value.toLowerCase();
    const cat = categorySelect.value;
    productGrid.innerHTML = '';
    const filtered = products.filter(p => {
      const matchesQ = p.name.toLowerCase().includes(q) || p.desc.toLowerCase().includes(q);
      const matchesCat = cat ? p.category === cat : true;
      return matchesQ && matchesCat;
    });
    filtered.forEach(p => {
      const card = document.createElement('div');
      card.className = 'product-card';
      card.innerHTML = `
        <img src="${p.img}" alt="${p.name}">
        <h4>${p.name}</h4>
        <div class="product-price">${formatCurrency(p.price)}</div>
        <div style="display:flex; gap:8px; justify-content:center;">
          <button class="btn btn-outline" onclick="openDetail(${p.id})">Detail</button>
          <button class="btn btn-primary" onclick="addToCart(${p.id})">Tambah</button>
        </div>
      `;
      productGrid.appendChild(card);
    });
  }

  searchInput.addEventListener('input', renderProducts);
  categorySelect.addEventListener('change', renderProducts);

  // Modal product
  const modal = document.getElementById('productModal');
  function openDetail(id){
    const p = products.find(x => x.id === id);
    if(!p) return;
    document.getElementById('modalTitle').innerText = p.name;
    document.getElementById('modalImage').src = p.img;
    document.getElementById('modalDesc').innerText = p.desc;
    document.getElementById('modalPrice').innerText = formatCurrency(p.price);
    document.getElementById('modalAdd').onclick = () => { addToCart(id); closeModal(); };
    modal.style.display = 'flex';
  }
  function closeModal(e){
    if(!e || e.target === modal) modal.style.display = 'none';
  }

  // Keranjang sederhana (localStorage)
  function getCart(){
    return JSON.parse(localStorage.getItem('cart') || '[]');
  }
  function saveCart(c){ localStorage.setItem('cart', JSON.stringify(c)); updateCartCount(); }
  function addToCart(id){
    const c = getCart();
    const item = c.find(x => x.id === id);
    if(item) item.qty++;
    else {
      const p = products.find(x => x.id === id);
      c.push({ id: p.id, name: p.name, price: p.price, qty:1 });
    }
    saveCart(c);
    alert('Produk ditambahkan ke keranjang');
  }
  function updateCartCount(){
    const c = getCart();
    const total = c.reduce((s,i)=>s+i.qty,0);
    cartCountEl.innerText = total;
  }

  // Cart modal
  const cartModal = document.getElementById('cartModal');
  function viewCart(){
    renderCartItems();
    cartModal.style.display = 'flex';
  }
  function renderCartItems(){
    const itemsEl = document.getElementById('cartItems');
    const c = getCart();
    if(c.length === 0){
      itemsEl.innerHTML = '<p>Keranjang kosong.</p>';
      document.getElementById('cartTotal').innerText = formatCurrency(0);
      return;
    }
    itemsEl.innerHTML = '';
    let total = 0;
    c.forEach(i => {
      total += i.price * i.qty;
      const el = document.createElement('div');
      el.style.display = 'flex';
      el.style.justifyContent = 'space-between';
      el.style.alignItems = 'center';
      el.style.marginBottom = '8px';
      el.innerHTML = `<div>
                        <strong>${i.name}</strong><br><small>${formatCurrency(i.price)} x ${i.qty}</small>
                      </div>
                      <div>
                        <button class="btn btn-outline" onclick="decreaseQty(${i.id})">-</button>
                        <button class="btn btn-outline" onclick="increaseQty(${i.id})">+</button>
                        <button class="btn btn-outline" onclick="removeItem(${i.id})">Hapus</button>
                      </div>`;
      itemsEl.appendChild(el);
    });
    document.getElementById('cartTotal').innerText = formatCurrency(total);
  }
  function increaseQty(id){
    const c = getCart();
    const it = c.find(x=>x.id===id);
    if(it){ it.qty++; saveCart(c); renderCartItems(); }
  }
  function decreaseQty(id){
    const c = getCart();
    const it = c.find(x=>x.id===id);
    if(it){ it.qty = Math.max(1, it.qty-1); saveCart(c); renderCartItems(); }
  }
  function removeItem(id){
    let c = getCart();
    c = c.filter(x=>x.id!==id);
    saveCart(c);
    renderCartItems();
  }
  function closeCart(e){
    if(!e || e.target === cartModal) cartModal.style.display = 'none';
  }
  function checkout(){
    // Simpel: kosongkan keranjang dan tunjukkan konfirmasi
    localStorage.removeItem('cart');
    updateCartCount();
    closeCart();
    alert('Checkout berhasil (simulasi).');
  }

  // logout helper (sama seperti di products.html)
  function logout(){
    localStorage.removeItem('login');
    window.location.href = 'login.html';
  }

  // init katalog
  renderProducts();
  updateCartCount();
</script>

<!-- script.js (grafik & fungsi lainnya) -->
<script src="script.js"></script>

</body>
</html>
